<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="/plugins/form-field-tooltip/css/form-field-tooltip.css" rel="stylesheet">
    <title>支付宝-统一收单交易关闭</title>
    <style>
        body {
            background-color: #EEEEEE;
            font-family: Trebuchet MS, Lucida Sans Unicode, Arial, sans-serif;
        }

        fieldset {
            width: 720px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
<div id="mainContainer">
    <h1>支付宝-统一收单交易关闭</h1>
    <fieldset>
        <legend>介绍</legend>
        <div>用于交易创建后，用户在一定时间内未进行支付，可调用该接口直接将未付款的交易进行关闭。</div>
    </fieldset>

    <fieldset>
        <legend>操作</legend>
        <input style="height: 40px;width: 150px;" type="button" value="发起请求" onclick='sendRequest()'/>
    </fieldset>
    <form id="alipay_form" autocomplete="off" method="post" action="/alipay/tradeClose/doClose">
        <fieldset>
            <legend>公共参数</legend>
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                <tbody>
                <tr>
                    <td style="vertical-align: top; width: 25%;">支付宝网关:
                    </td>
                    <td style="vertical-align: top; width: 75%;">
                        <select style="width: 100%" name="server_url">
                            <option value="https://openapi.alipaydev.com/gateway.do">沙箱环境</option>
                            <option value="https://openapi.alipay.com/gateway.do">正式环境</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: top; width: 25%;">支付宝公钥:
                    </td>
                    <td style="vertical-align: top; width: 75%;">
                        <textarea style="width: 100%;min-height: 120px;max-height: 120px;" id="alipay_public_key"
                                  name="alipay_public_key" placeholder="必填">${session.alipay_public_key}</textarea>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: top; width: 25%;">商户私钥:
                    </td>
                    <td style="vertical-align: top; width: 75%;">
                        <textarea style="width: 100%;min-height: 120px;max-height: 120px;" id="merchant_private_key"
                                  name="merchant_private_key"
                                  placeholder="必填">${session.merchant_private_key}</textarea>
                    </td>
                </tr>
                </tbody>
            </table>
        </fieldset>

        <fieldset>
            <legend>请求基本参数</legend>
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                <tbody>
                <tr>
                    <td style="vertical-align: top; width: 25%;">应用ID:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="app_id" name="app_id" value="${session.app_id}"
                               placeholder="必填,示例：2014072300007148"
                               tooltipText="支付宝分配给开发者的应用ID<br>示例：2014072300007148">
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">字符编码:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="charset" name="charset" value="utf-8" readonly>
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">签名类型:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="sign_type" name="sign_type" value="RSA2" readonly>
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">接口版本:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="version" name="version" value="1.0" readonly>
                    </td>
                </tr>

                </tbody>
            </table>
        </fieldset>

        <fieldset>
            <legend>业务参数</legend>
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                <tbody>

                <tr>
                    <td style="vertical-align: top; width: 25%;">支付宝流水号:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="trade_no" name="trade_no" placeholder="必填"
                               tooltipText="该交易在支付宝系统中的交易流水号。最短 16 位，最长 64 位。和out_trade_no不能同时为空，如果同时传了 out_trade_no和 trade_no，则以 trade_no为准。">
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">商户流水号:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="out_trade_no" name="out_trade_no" placeholder="必填"
                               tooltipText="订单支付时传入的商户订单号,和支付宝交易号不能同时为空。 trade_no,out_trade_no如果同时存在优先取trade_no">
                    </td>
                </tr>

                </tbody>
            </table>
        </fieldset>
    </form>
</div>
<script src="/plugins/form-field-tooltip/js/rounded-corners.js"></script>
<script src="/plugins/form-field-tooltip/js/form-field-tooltip.js"></script>
<script src="/plugins/jquery.min.js"></script>
<script>

    function sendRequest() {
        var form = $("#alipay_form");
        var url = form.attr("action");
        $.post(url, form.serializeArray(), function (resp) {
            alert(resp.msg);
            window.location.reload();
        });
    }

    var tooltipObj = new DHTMLgoodies_formTooltip();
    tooltipObj.setTooltipPosition('right');
    tooltipObj.imagePath = "/plugins/form-field-tooltip/images/";
    tooltipObj.setPageBgColor('#EEEEEE');
    tooltipObj.setTooltipCornerSize(15);
    tooltipObj.setCloseMessage("关闭");
    tooltipObj.setDisableTooltipMessage("关闭提示");
    tooltipObj.initFormFieldTooltip();
</script>
</body>
</html>