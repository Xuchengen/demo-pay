<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="/plugins/form-field-tooltip/css/form-field-tooltip.css" rel="stylesheet">
    <title>支付宝-手机网站支付</title>
    <style>
        body {
            background-color: #EEEEEE;
            font-family: Trebuchet MS, Lucida Sans Unicode, Arial, sans-serif;
        }

        fieldset {
            width: 720px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
<div id="mainContainer">
    <h1>支付宝-手机网站支付</h1>
    <fieldset>
        <legend>介绍</legend>
        <div>适用于商家在移动端网页应用中集成支付宝支付功能。
            商家在网页中调用支付宝提供的网页支付接口调起支付宝客户端内的支付模块，商家网页会跳转到支付宝中完成支付，支付完后跳回到商家网页内，最后展示支付结果。若无法唤起支付宝客户端，则在一定的时间后会自动进入网页支付流程。
        </div>
    </fieldset>

    <fieldset>
        <legend>操作</legend>
        <input style="height: 40px;width: 150px;" type="button" value="随机订单号" onclick='newOrder()'/>
        <input style="height: 40px;width: 150px;" type="button" value="发起请求" onclick='sendRequest()'/>
        <input style="height: 40px;width: 150px;" type="button" value="手机请求" onclick='mobileRequest()'/>
    </fieldset>
    <form id="alipay_form" autocomplete="off" method="post" action="/alipay/wapPay/doPay">
        <fieldset>
            <legend>公共参数</legend>
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                <tbody>
                <tr>
                    <td style="vertical-align: top; width: 25%;">支付宝网关:
                    </td>
                    <td style="vertical-align: top; width: 75%;">
                        <select style="width: 100%" name="server_url">
                            <option value="https://openapi.alipaydev.com/gateway.do">沙箱环境</option>
                            <option value="https://openapi.alipay.com/gateway.do">正式环境</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: top; width: 25%;">支付宝公钥:
                    </td>
                    <td style="vertical-align: top; width: 75%;">
                        <textarea style="width: 100%;min-height: 120px;max-height: 120px;" id="alipay_public_key"
                                  name="alipay_public_key" placeholder="必填">${session.alipay_public_key}</textarea>
                    </td>
                </tr>
                <tr>
                    <td style="vertical-align: top; width: 25%;">商户私钥:
                    </td>
                    <td style="vertical-align: top; width: 75%;">
                        <textarea style="width: 100%;min-height: 120px;max-height: 120px;" id="merchant_private_key"
                                  name="merchant_private_key"
                                  placeholder="必填">${session.merchant_private_key}</textarea>
                    </td>
                </tr>
                </tbody>
            </table>
        </fieldset>

        <fieldset>
            <legend>
                请求基本参数
            </legend>
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                <tbody>
                <tr>
                    <td style="vertical-align: top; width: 25%;">应用ID:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="app_id" name="app_id" value="${session.app_id}"
                               placeholder="必填,示例：2014072300007148"
                               tooltipText="支付宝分配给开发者的应用ID<br>示例：2014072300007148">
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">字符编码:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="charset" name="charset" value="utf-8" readonly>
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">签名类型:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="sign_type" name="sign_type" value="RSA2" readonly>
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">接口版本:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="version" name="version" value="1.0" readonly>
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">通知地址:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="notify_url" name="notify_url" value="${notifyUrl}"
                               placeholder="选填"
                               tooltipText="支付宝服务器主动通知商户服务器里指定的页面http/https路径。">
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">返回地址:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="return_url" name="return_url" value="${returnUrl}"
                               placeholder="选填"
                               tooltipText="支付宝服务器主动返回的页面http/https路径。">
                    </td>
                </tr>
                </tbody>
            </table>
        </fieldset>

        <fieldset>
            <legend>
                业务参数
            </legend>
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                <tbody>

                <tr>
                    <td style="vertical-align: top; width: 25%;">商户订单号:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="out_trade_no" name="out_trade_no" placeholder="必填"
                               tooltipText="商户订单号,64个字符以内、只能包含字母、数字、下划线；需保证在商户端不重复">
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">订单标题:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="subject" name="subject" value="手机网站支付接口测试"
                               tooltipText="订单标题">
                    </td>
                </tr>

                <tr>
                    <td style="vertical-align: top; width: 25%;">订单金额:</td>
                    <td style="vertical-align: top; width: 75%;">
                        <input style="width: 100%;" id="total_amount" name="total_amount" value="0.01" readonly>
                    </td>
                </tr>
                </tbody>
            </table>
        </fieldset>
    </form>
</div>
<script src="/plugins/form-field-tooltip/js/rounded-corners.js"></script>
<script src="/plugins/form-field-tooltip/js/form-field-tooltip.js"></script>
<script src="/plugins/jquery.min.js"></script>
<script>
    function newOrder() {
        $.post('/common/getOrderNo', {}, function (resp) {
            $("#out_trade_no").val(resp);
        });
    }

    function sendRequest() {
        $("#alipay_form").submit();
    }

    function mobileRequest() {
        var form = $("#alipay_form");
        form.attr("action", "/alipay/wapPay/genQrcode");
        form.attr("method", "post");
        form.submit();
    }

    var tooltipObj = new DHTMLgoodies_formTooltip();
    tooltipObj.setTooltipPosition('right');
    tooltipObj.imagePath = "/plugins/form-field-tooltip/images/";
    tooltipObj.setPageBgColor('#EEEEEE');
    tooltipObj.setTooltipCornerSize(15);
    tooltipObj.setCloseMessage("关闭");
    tooltipObj.setDisableTooltipMessage("关闭提示");
    tooltipObj.initFormFieldTooltip();
</script>
</body>
</html>